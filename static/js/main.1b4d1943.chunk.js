(this["webpackJsonpreact-uod-cal"]=this["webpackJsonpreact-uod-cal"]||[]).push([[0],{21:function(e,t,a){e.exports=a(31)},26:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(3),o=a.n(s),l=(a(26),a(14)),i=a(15),c=a(20),u=a(19),p=a(11),d=a(7),m=a.n(d);a(30);m.a.locale("en",{week:{dow:1,doy:1}});var h=Object(p.b)(m.a);function v(e){var t=e.event;console.log(t);var a="https://www.dundee.ac.uk/module/"+t.modcode,n=[],s="https://www.dundee.ac.uk/people/";if(2===t.staff.split(",").length)n.push(r.a.createElement("a",{href:s+t.staff.split(",")[1].trim()+"-"+t.staff.split(",")[0].trim()}," ",t.staff.split(",")[1],"-",t.staff.split(",")[0]," "));else for(var o=t.staff.split(","),l=0;l<o.length;l++)n.push(r.a.createElement("a",{href:s+o[l+1].trim()+"-"+o[l].trim()}," ",o[l+1].trim()+" "+o[l].trim()," ")),l++;return console.log(n),r.a.createElement("div",{className:"event-wrapper"},r.a.createElement("div",{className:"event-type"},t.type),r.a.createElement("div",{className:"event-module"},r.a.createElement("a",{href:a},t.modcode," ",t.moduleName)),r.a.createElement("div",{className:"event-room"},"&nbsp;"===t.room?"n/a":t.room),r.a.createElement("div",{className:"event-staff"},n))}var f=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var r=new Date;r.setHours(8,0,0);var s=new Date;return s.setHours(20,0,0),n.state={minTime:r,maxTime:s},n}return Object(i.a)(a,[{key:"openUrl",value:function(){void 0!==this.state.matric&&window.open(window.location.origin+window.location.pathname+"/?s="+this.state.matric,"_self")}},{key:"_HandleInput",value:function(e){"Enter"===e.key&&(console.log("hit"),this.openUrl())}},{key:"_HandleChange",value:function(e){console.log(e),this.setState({matric:e})}},{key:"render",value:function(){var e=this,t={agenda:{event:v}};return r.a.createElement("div",{id:"container"},r.a.createElement("p",null,null==this.state.calendar?"Enter Matric":""),r.a.createElement(p.a,{components:t,localizer:h,events:null==this.state.calendar?[]:this.state.calendar,startAccessor:"start",endAccessor:"end",style:null==this.state.calendar?{display:"none"}:{height:700},defaultView:"agenda",min:this.state.minTime,max:this.state.maxTime,formats:{agendaHeaderFormat:function(e){var t=e.start,a=e.end;return m.a.utc(t).format("DD/MM/YYYY")+" - "+m.a.utc(a).format("DD/MM/YYYY")}}}),r.a.createElement("div",{className:"matric-input",style:null!=this.state.calendar?{display:"none"}:{}},r.a.createElement("form",null,r.a.createElement("input",{onChange:function(t){return e._HandleChange(t.target.value)},onKeyDown:function(t){return e._HandleInput(t)},name:"matriculation"}),r.a.createElement("button",{onClick:function(){return e.openUrl()},type:"submit"},"submit"))))}},{key:"tableToJson",value:function(e){for(var t=[],a=[],n=0;n<e.rows[0].cells.length;n++)a[n]=e.rows[0].cells[n].innerHTML.toLowerCase().replace(/ /gi,"");for(var r=1;r<e.rows.length;r++){for(var s=e.rows[r],o={},l=0;l<s.cells.length;l++)o[a[l]]=s.cells[l].innerHTML;t.push(o)}return t}},{key:"parseTimetable",value:function(e){var t=[];function a(e,t){return new Date(e.getTime()+6e4*t)}function n(e){if(e.includes("-")){for(var t=e.split("-"),a=[],n=parseInt(t[0].trim());n<=parseInt(t[1].trim());n++)a.push(parseInt(n));return a}var r=[];return r.push(parseInt(e.trim())),r}function r(e){var t=e.split(":"),a=[];return a.push(parseInt(t[0].trim())),a.push(parseInt(t[1].trim())),a}function s(e,t){var a=new Date(e);return a.setDate(a.getDate()+t),a}for(var o=new Date(2020,9,5),l=new Date(2021,0,18),i={},c=0;c<e.length;c++)for(var u=c,p=0;p<e[c].length;p++){var d=e[c][p],m=d.activity.split(" ")[0];m.includes("/")?m=m.split("/")[0]:m.includes("-")&&(m=m.split("-")[0]);(m=m.replace(/[^0-9a-z]/gi,""))in i||(i[m]=this.getModuleInfo("https://www.dundee.ac.uk/module/"+m));var h=i[m],v=[];if(d.weeks.includes("-")&&d.weeks.includes(","))for(var f=d.weeks.split(","),w=0;w<f.length;w++)v=v.concat(n(f[w]));else if(d.weeks.includes(","))for(var g=d.weeks.split(","),y=0;y<g.length;y++)v=v.concat(n(g[y]));else v=(d.weeks.includes("-"),v.concat(n(d.weeks)));for(var k=0;k<v.length;k++){var b=void 0;v[k]>=12?(v[k]=v[k]-12,b=s(l,7*v[k])):b=s(o,7*(v[k]-1)),b=s(b,u);var E=r(d.start),T=a(b,60*E[0]);T=a(T,E[1]);var D=r(d.end),M=a(b,60*D[0]);M=a(M,D[1]);var H={title:d.type+" | "+h+" | "+d.activity.split(" ")[0],type:d.type,start:T,end:M,allDay:!1,moduleName:h,modcode:m,room:d.room,activity:d.activity,staff:d.staff,duration:d.duration};t.push(H)}}return console.log(t),t}},{key:"getModuleInfo",value:function(e){var t=new XMLHttpRequest;return t.open("GET","https://secret-chamber-30285.herokuapp.com/"+e,!1),t.send(),t.responseText.split("<title>")[1].split("module")[0].trim()}},{key:"getTimetable",value:function(e){if(""!==e&&void 0!==e&&null!==e){"https://mysterious-everglades-22580.herokuapp.com/","https://cors-spooky.herokuapp.com/","https://secret-chamber-30285.herokuapp.com/";var t="https://timetable.dundee.ac.uk:8084/reporting/textspreadsheet?objectclass=student+set&idtype=id&identifier="+e+"/1&t=SWSCUST+student+set+textspreadsheet&days=1-7&weeks=1-52&periods=1-28&template=SWSCUST+student+set+textspreadsheet",a=new XMLHttpRequest;a.open("GET","https://secret-chamber-30285.herokuapp.com/"+t,!1),a.send();var n=a.responseText;if(void 0!==(n=n.split("<p><span class='labelone'>Monday</span></p>")[1])){for(var r=(n=n.split("<p><span class='labelone'>Saturday</span></p>")[0]).split("</span></p>"),s=[],o=0;o<r.length;o++){r[o].includes("<p><span class='labelone'")&&(r[o]=r[o].split("</table>")[0]);var l=(new DOMParser).parseFromString(r[o],"text/html");s.push(this.tableToJson(l.body.firstChild))}console.log(s);var i=this.parseTimetable(s);this.setState({calendar:i})}}}},{key:"componentDidMount",value:function(){console.log(window.location.search),this.getTimetable(window.location.search.split("=")[1])}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.1b4d1943.chunk.js.map